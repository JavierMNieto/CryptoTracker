{% load compress %}
{% load static %}
{% load coin_extras %}
<!DOCTYPE html>
<html ng-app="txs">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>USDT/BTC Market Tracker</title>
	<link rel="shortcut icon" href="{% static 'images/tracking.png' %}">
	<link rel="icon" href="{% static 'images/tracking.png' %}">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/vis/4.16.1/vis.css" type="text/css" />
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.16.1/vis-network.min.js"> </script>
	<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.7.6/angular.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/lodash@4.17.11/lodash.min.js"></script>
	<script src="https://morgul.github.io/ui-bootstrap4/ui-bootstrap-tpls-3.0.6.min.js"></script>
	<script type="text/javascript" src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
	<script type="text/javascript" src="https://momentjs.com/downloads/moment-timezone-with-data.min.js"></script>
	<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>
	<script src="https://kit.fontawesome.com/af6506c08e.js"></script>
	<script src="{% static 'js/clipboard.min.js' %}"></script>
	<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css"/>
	<link rel="stylesheet" href="{% static 'css/coin.css' %}">
</head>
{%if search.totalTxs < 1 %}
	<div class="h2 text-center mx-auto">{{search.address}}</div>
	<div class="h1 text-center">No Transactions</div>
{% else %}
	<script>
		{%if search.addr %}
			const _addr = {{search.addr | safe}};
		{% else %}
			const _addr = null;
		{% endif %}
		var totalTxs   = {{search.totalTxs}};
		const dFilters = {{search.filters | safe}};
		const minTx    = dFilters.minTx;
		const lastTx   = {{search.lastTx}}; // Change
		var network;
		var container;
		var options, data;
		const satoshi = 100000000.0;
	</script>
	<script src="{% static 'js/coinController.js' %}"></script>
</head>

<body ng-controller="txsController as vm" class="container-fluid">
	<div id="body" class="ng-cloak">
		<div id="name" class="font-weight-bold text-center h1">
			{{search.label}}
			<button width="30" height="30" onclick="location.reload();" ng-click="vm.startLoader();" class="btn btn-icon rounded" style="background-color: rgba(0, 0, 0, 0)" data-toggle="tooltip" data-placement="right" title="Refresh Page">
				<svg width="30" height="30" viewBox="0 0 65 65">
					<path d="m32.5 4.999c-5.405 0-10.444 1.577-14.699 4.282l-5.75-5.75v16.11h16.11l-6.395-6.395c3.18-1.787 6.834-2.82 10.734-2.82 12.171 0 22.073 9.902 22.073 22.074 0 2.899-0.577 5.664-1.599 8.202l4.738 2.762c1.47-3.363 2.288-7.068 2.288-10.964 0-15.164-12.337-27.501-27.5-27.501z" fill="#555753"/>
					<path d="m43.227 51.746c-3.179 1.786-6.826 2.827-10.726 2.827-12.171 0-22.073-9.902-22.073-22.073 0-2.739 0.524-5.35 1.439-7.771l-4.731-2.851c-1.375 3.271-2.136 6.858-2.136 10.622 0 15.164 12.336 27.5 27.5 27.5 5.406 0 10.434-1.584 14.691-4.289l5.758 5.759v-16.112h-16.111l6.389 6.388z" fill="#555753"/>
				</svg>
			</button>
		</div>
		{% if search.label != 'All Addresses' %}
		<div class="row justify-content-center" id='info'>
			{% if search.address is not None %}
			<div class="h5">
				Address:&nbsp <span class="h6">{{search.address}}</span>
				<button width="16" height="16" class="btn btn-icon rounded" style="background-color: rgba(0, 0, 0, 0)" data-clipboard-text="{{ search.address }}" data-toggle="tooltip" data-placement="top" title="Copy Address">
					<svg width="16" height="16" viewBox="0 0 67 67">
						<path d="M61.559,16.528L44.432,0.713C44.064,0.377,43.583,0,43.083,0H25.446c-5.407,0-9.134,2.81-9.134,6.877V12h-3.358    c-4.946,0-8.642,3.124-8.642,7.369V59.37c0,4.492,4.077,7.63,8.642,7.63h29.231c4.677,0,8.127-3.288,8.127-7.63V55h4.365    c4.41,0,7.635-3.513,7.635-8.122V18.555c0-0.029,0.242-0.057,0.241-0.085c0.001-0.03,0.134-0.059,0.134-0.089    C62.688,17.541,62.293,16.824,61.559,16.528z M44.312,6.665L55.462,16H44.312V6.665z M46.312,59.37c0,2.363-1.938,3.63-4.127,3.63    H12.955c-2.323,0-4.642-1.381-4.642-3.63V19.369c0-2.6,3.095-3.369,4.642-3.369h15.358v15.381c0,1.104,1.396,1.619,2.5,1.619h15.5    V59.37z M44.028,29H32.312v-9.878L44.028,29z M54.677,51h-4.365V31.047c0-0.562,0.014-1.097-0.4-1.476l-17.43-16.059    c-0.324-0.667-0.94-1.132-1.732-1.132c-0.036,0-0.039-0.182-0.075-0.18c-0.038-0.002-0.044-0.201-0.083-0.201h-10.28V6.876    c0-2.063,3.02-2.877,5.134-2.877h14.866V18.38c0,1.104,1.396,1.619,2.5,1.619h15.5v26.878C58.312,49.276,56.881,51,54.677,51z" fill="#639dc7"/>
					</svg>
				</button>
			</div>
			{% endif %}
			<div class="px-5 h5">
				Balance: {{search.balance | numCommas}}
				<button width="16" height="16" class="btn btn-icon rounded" style="background-color: rgba(0, 0, 0, 0)" data-clipboard-text="{{ search.balance }}" data-toggle="tooltip" data-placement="top" title="Copy Balance">
					<svg width="16" height="16" viewBox="0 0 67 67">
						<path d="M61.559,16.528L44.432,0.713C44.064,0.377,43.583,0,43.083,0H25.446c-5.407,0-9.134,2.81-9.134,6.877V12h-3.358    c-4.946,0-8.642,3.124-8.642,7.369V59.37c0,4.492,4.077,7.63,8.642,7.63h29.231c4.677,0,8.127-3.288,8.127-7.63V55h4.365    c4.41,0,7.635-3.513,7.635-8.122V18.555c0-0.029,0.242-0.057,0.241-0.085c0.001-0.03,0.134-0.059,0.134-0.089    C62.688,17.541,62.293,16.824,61.559,16.528z M44.312,6.665L55.462,16H44.312V6.665z M46.312,59.37c0,2.363-1.938,3.63-4.127,3.63    H12.955c-2.323,0-4.642-1.381-4.642-3.63V19.369c0-2.6,3.095-3.369,4.642-3.369h15.358v15.381c0,1.104,1.396,1.619,2.5,1.619h15.5    V59.37z M44.028,29H32.312v-9.878L44.028,29z M54.677,51h-4.365V31.047c0-0.562,0.014-1.097-0.4-1.476l-17.43-16.059    c-0.324-0.667-0.94-1.132-1.732-1.132c-0.036,0-0.039-0.182-0.075-0.18c-0.038-0.002-0.044-0.201-0.083-0.201h-10.28V6.876    c0-2.063,3.02-2.877,5.134-2.877h14.866V18.38c0,1.104,1.396,1.619,2.5,1.619h15.5v26.878C58.312,49.276,56.881,51,54.677,51z" fill="#639dc7"/>
					</svg>
				</button>
			</div>
		</div>
		{% endif %}
		<div class="row mx-auto p-1" style="width: 95%" id='filters'>
			<div class="row mx-auto">
				<div class="dropdown dropdown-hover mx-2">
					<button class="btn btn-dark dropdown-toggle shadow-none" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
						Balance
					</button>
					<div class="dropdown-menu mt-n1" style="min-width: 10vw">
						<input autocomplete="off" ng-change="vm.addCommas('minBal');" type="text" name="minBal" class="form-control text-center text-truncate mx-auto shadow m-1" placeholder="Min Balance" ng-model="vm.graphFilters.minBal">
						<input autocomplete="off" ng-change="vm.addCommas('maxBal');" type="text" name="maxBal" class="form-control text-center text-truncate mx-auto shadow m-1" placeholder="Max Balance" ng-model="vm.graphFilters.maxBal">
					</div>
				</div>

				<div class="dropdown dropdown-hover mx-2" id="time">
					<button class="btn btn-dark dropdown-toggle shadow-none" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
						Time
					</button>
					<div class="dropdown-menu mt-n1" name="dateTimes" style="min-width: 15vw">
						<input autocomplete="off" type="text" name="minTime" class="form-control text-center text-truncate mx-auto shadow m-1" placeholder="Min Tx Time" ng-model="vm.graphFilters.minTime">
						<input autocomplete="off" type="text" name="maxTime" class="form-control text-center text-truncate mx-auto shadow m-1" placeholder="Max Tx Time" ng-model="vm.graphFilters.maxTime">
					</div>
				</div> 
				<div class="dropdown dropdown-hover mx-2">
					<button class="btn btn-dark dropdown-toggle shadow-none" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
						Transaction Amount
					</button>
					<div class="dropdown-menu mt-n1" style="min-width: 10vw">
						<input autocomplete="off" ng-change="vm.addCommas('minTx');" type="text" name="minTx" class="form-control text-center text-truncate mx-auto shadow m-1" placeholder="Min Tx" ng-model="vm.graphFilters.minTx">
						<input autocomplete="off" ng-change="vm.addCommas('maxTx');" type="text" name="maxTx" class="form-control text-center text-truncate mx-auto shadow m-1" placeholder="Max Tx" ng-model="vm.graphFilters.maxTx">
					</div>
				</div>
			</div>
			<div class="btn-group block" style="position: absolute; right: 3.5%;">
				<button ng-click="vm.setFilters()" class="btn btn-primary block" id="filterBtn">Set Filters</button>
				<button id="resetBtn" type="button" class="btn btn-dark dropdown-toggle-split" ng-click="vm.loadGraph()" data-toggle="tooltip" data-placement="top" title="Load Graph">
					<svg height="24" viewBox="-14 0 277 277.50116" width="24">
						<path
							d="m194.421875 185.890625c1.742187-.828125 2.851563-2.582031 2.851563-4.511719v-59.960937c0-2.761719-2.238282-5-5-5-2.761719 0-5 2.238281-5 5v56.800781l-58 27.601562v-74.164062l65.132812-31.019531c2.492188-1.183594 3.554688-4.167969 2.367188-6.664063-.40625-.792968-1.023438-1.464844-1.785157-1.933594-.160156-.183593-.359375-.332031-.582031-.429687l-68-32.375c-1.359375-.648437-2.941406-.648437-4.300781 0l-68 32.375c-.0625.035156-.089844.082031-.152344.113281-.121094.0625-.25.101563-.367187.171875-1.449219.917969-2.328126 2.511719-2.328126 4.226563v85.253906c0 1.925781 1.109376 3.683594 2.847657 4.511719l68 32.375c1.320312.648437 2.863281.648437 4.183593 0h.117188zm-133.121094-81.847656 20.945313 9.972656c2.488281 1.164063 5.449218.101563 6.632812-2.378906 1.179688-2.480469.136719-5.449219-2.332031-6.648438l-18.617187-8.867187 56.359374-26.835938 56.355469 26.835938-56.355469 26.839844-17.527343-8.347657c-2.488281-1.164062-5.449219-.097656-6.632813 2.378907-1.179687 2.480468-.140625 5.449218 2.332032 6.652343l16.832031 8v74.1875l-58-27.601562zm0 0" fill="#9a9ca0"/>
						<path
							d="m143.855469 16.332031 12.46875-6.964843c2.414062-1.347657 3.277343-4.394532 1.929687-6.804688-1.347656-2.410156-4.394531-3.273438-6.804687-1.929688l-26 14.511719c-1.339844.746094-2.257813 2.066407-2.5 3.582031-.238281 1.515626.230469 3.054688 1.273437 4.179688l20.640625 22.246094c1.199219 1.359375 3.046875 1.960937 4.820313 1.570312 1.773437-.386718 3.195312-1.707031 3.714844-3.449218.523437-1.738282.058593-3.621094-1.207032-4.921876l-11.457031-12.359374c54.632813 8.082031 95.675781 54.066406 97.519531 109.261718 1.847656 55.199219-36.03125 103.824219-90.003906 115.535156-2.5.539063-4.191406 2.875-3.917969 5.417969.269531 2.542969 2.414063 4.472657 4.96875 4.472657.355469 0 .710938-.039063 1.0625-.117188 58.394531-12.664062 99.523438-65.082031 97.933594-124.816406-1.59375-59.734375-45.449219-109.886719-104.4375-119.425782zm0 0" fill="#9a9ca0"/>
						<path
							d="m103.722656 232.351562c-1.214844-1.320312-3.039062-1.886718-4.785156-1.492187s-3.148438 1.695313-3.675781 3.40625c-.527344 1.714844-.09375 3.578125 1.128906 4.886719l11.457031 12.347656c-54.808594-8.09375-95.921875-54.324219-97.566406-109.699219-1.640625-55.378906 36.664062-103.960937 90.894531-115.285156 2.707031-.5625 4.441407-3.210937 3.878907-5.914063-.5625-2.703124-3.210938-4.441406-5.914063-3.878906-58.664063 12.261719-100.230469 64.632813-98.859375 124.550782 1.375 59.914062 45.296875 110.324218 104.460938 119.890624l-12.492188 6.96875c-2.410156 1.347657-3.273438 4.394532-1.929688 6.804688 1.347657 2.414062 4.394532 3.277344 6.804688 1.929688l26-14.507813c1.339844-.75 2.261719-2.070313 2.5-3.585937.238281-1.511719-.230469-3.054688-1.269531-4.179688zm0 0" fill="#9a9ca0"/>
					</svg>
				</button>
			</div>
		</div>
		<div class="row mx-auto w-75">
			{% for f, val in search.filters.items %}
				{% if val|isNum and search.dFilters|dict_key:f != val %}
					<button class="btn badge badge-pill badge-danger mx-2 mb-2 shadow-none" name="{{f}}" data-value="{{f|getDefault}}" ng-click="vm.removeFilter($event)">
						{% if f|contains:"time" %}
							<span class="font-weight-lighter" ng-init-time callback-fn="vm.formatTime(time)" data-unix="{{val}}" data-name="{{f|filterName}}"></span>
						{% else %}
							<span class="font-weight-lighter">
								{{f|filterName}}: {{val|numCommas}}
							</span>
						{% endif %}
						<i class="fa fa-times fa-sm ml-1"></i>
					</button>
				{% endif %}
			{% endfor %}
		</div>
		<div class="row mx-auto text-center" id='graphContainer'>
			<div id="graph">
				<div style="margin-top: 35vh;color: grey; mix-blend-mode: difference">
					Large Graph! Site May Lag While Loading! <br>
					Press
					<svg height="36" viewBox="-14 0 277 277.50116" width="36">
						<path
							d="m194.421875 185.890625c1.742187-.828125 2.851563-2.582031 2.851563-4.511719v-59.960937c0-2.761719-2.238282-5-5-5-2.761719 0-5 2.238281-5 5v56.800781l-58 27.601562v-74.164062l65.132812-31.019531c2.492188-1.183594 3.554688-4.167969 2.367188-6.664063-.40625-.792968-1.023438-1.464844-1.785157-1.933594-.160156-.183593-.359375-.332031-.582031-.429687l-68-32.375c-1.359375-.648437-2.941406-.648437-4.300781 0l-68 32.375c-.0625.035156-.089844.082031-.152344.113281-.121094.0625-.25.101563-.367187.171875-1.449219.917969-2.328126 2.511719-2.328126 4.226563v85.253906c0 1.925781 1.109376 3.683594 2.847657 4.511719l68 32.375c1.320312.648437 2.863281.648437 4.183593 0h.117188zm-133.121094-81.847656 20.945313 9.972656c2.488281 1.164063 5.449218.101563 6.632812-2.378906 1.179688-2.480469.136719-5.449219-2.332031-6.648438l-18.617187-8.867187 56.359374-26.835938 56.355469 26.835938-56.355469 26.839844-17.527343-8.347657c-2.488281-1.164062-5.449219-.097656-6.632813 2.378907-1.179687 2.480468-.140625 5.449218 2.332032 6.652343l16.832031 8v74.1875l-58-27.601562zm0 0" fill="#9a9ca0"/>
						<path
							d="m143.855469 16.332031 12.46875-6.964843c2.414062-1.347657 3.277343-4.394532 1.929687-6.804688-1.347656-2.410156-4.394531-3.273438-6.804687-1.929688l-26 14.511719c-1.339844.746094-2.257813 2.066407-2.5 3.582031-.238281 1.515626.230469 3.054688 1.273437 4.179688l20.640625 22.246094c1.199219 1.359375 3.046875 1.960937 4.820313 1.570312 1.773437-.386718 3.195312-1.707031 3.714844-3.449218.523437-1.738282.058593-3.621094-1.207032-4.921876l-11.457031-12.359374c54.632813 8.082031 95.675781 54.066406 97.519531 109.261718 1.847656 55.199219-36.03125 103.824219-90.003906 115.535156-2.5.539063-4.191406 2.875-3.917969 5.417969.269531 2.542969 2.414063 4.472657 4.96875 4.472657.355469 0 .710938-.039063 1.0625-.117188 58.394531-12.664062 99.523438-65.082031 97.933594-124.816406-1.59375-59.734375-45.449219-109.886719-104.4375-119.425782zm0 0" fill="#9a9ca0"/>
						<path
							d="m103.722656 232.351562c-1.214844-1.320312-3.039062-1.886718-4.785156-1.492187s-3.148438 1.695313-3.675781 3.40625c-.527344 1.714844-.09375 3.578125 1.128906 4.886719l11.457031 12.347656c-54.808594-8.09375-95.921875-54.324219-97.566406-109.699219-1.640625-55.378906 36.664062-103.960937 90.894531-115.285156 2.707031-.5625 4.441407-3.210937 3.878907-5.914063-.5625-2.703124-3.210938-4.441406-5.914063-3.878906-58.664063 12.261719-100.230469 64.632813-98.859375 124.550782 1.375 59.914062 45.296875 110.324218 104.460938 119.890624l-12.492188 6.96875c-2.410156 1.347657-3.273438 4.394532-1.929688 6.804688 1.347657 2.414062 4.394532 3.277344 6.804688 1.929688l26-14.507813c1.339844-.75 2.261719-2.070313 2.5-3.585937.238281-1.511719-.230469-3.054688-1.269531-4.179688zm0 0" fill="#9a9ca0"/>
					</svg>
					to Load Graph
				</div>
			</div>
			<div id="loadingBar">
				<div class="outerBorder">
					<div id="text">0%</div>
					<div id="border">
						<div id="bar"></div>
					</div>
				</div>
			</div>
			<div style="position: absolute; left: 97.5%">
				<div>
					<button ng-disabled="!vm.isGraph" ngsf-toggle-fullscreen width="16px" height="16px" class="btn position-relative btn-sm" onclick="fullGraph()" data-toggle="tooltip" data-placement="top" title="Fullscreen Graph">
						<svg width="16px" height="16px" viewBox="0 0 438.543 438.543">
							<path d="M407.42,159.029c3.62,3.616,7.898,5.428,12.847,5.428c2.282,0,4.668-0.476,7.139-1.429   c7.426-3.235,11.136-8.853,11.136-16.846V18.276c0-4.949-1.807-9.231-5.428-12.847c-3.61-3.617-7.898-5.424-12.847-5.424H292.36   c-7.991,0-13.607,3.805-16.848,11.419c-3.23,7.423-1.902,13.99,4,19.698l41.111,41.112L219.271,173.589L117.917,72.231   l41.112-41.112c5.901-5.708,7.232-12.275,3.999-19.698C159.789,3.807,154.175,0,146.182,0H18.276C13.324,0,9.041,1.809,5.425,5.426   c-3.617,3.616-5.424,7.898-5.424,12.847v127.907c0,7.996,3.809,13.61,11.419,16.846c2.285,0.948,4.57,1.429,6.855,1.429   c4.948,0,9.229-1.812,12.847-5.427l41.112-41.109l101.354,101.354L72.234,320.622l-41.112-41.113   c-5.711-5.903-12.275-7.231-19.702-4.001c-7.614,3.241-11.419,8.856-11.419,16.854v127.906c0,4.948,1.807,9.229,5.424,12.847   c3.619,3.614,7.902,5.421,12.851,5.421h127.906c7.996,0,13.61-3.806,16.846-11.416c3.234-7.427,1.903-13.99-3.999-19.705   l-41.112-41.106L219.271,264.95l101.353,101.361l-41.114,41.11c-5.899,5.708-7.228,12.279-3.997,19.698   c3.237,7.617,8.856,11.423,16.851,11.423h127.907c4.948,0,9.232-1.813,12.847-5.428c3.613-3.613,5.42-7.898,5.42-12.847V292.362   c0-7.994-3.709-13.613-11.136-16.851c-7.802-3.23-14.462-1.903-19.985,4.004l-41.106,41.106L264.952,219.271L366.31,117.917   L407.42,159.029z"/>
						</svg>
					</button>
				</div>
				<div class="row mx-auto">
					<button ng-disabled="!vm.isGraph" width="16px" height="16px" class="btn position-absolute btn-sm" onclick="toggleDarkMode()" data-toggle="tooltip" data-placement="top" title="Toggle Graph Dark Mode">
						<svg width="16px" height="16px" viewBox="-12 0 448 448.04455">
							<path d="m224.023438 448.03125c85.714843.902344 164.011718-48.488281 200.117187-126.230469-22.722656 9.914063-47.332031 14.769531-72.117187 14.230469-97.15625-.109375-175.890626-78.84375-176-176 .972656-65.71875 37.234374-125.832031 94.910156-157.351562-15.554688-1.980469-31.230469-2.867188-46.910156-2.648438-123.714844 0-224.0000005 100.289062-224.0000005 224 0 123.714844 100.2851565 224 224.0000005 224zm0 0"/>
						</svg>
					</button>
				</div>
			</div>
		</div>
		<div ng-if="vm.selection !== undefined" id='selection'>
			<div class="list-group-item mx-auto container" style="padding-top: 2vh; width: 90%">
				<div ng-switch="vm.selection.url">
					<div ng-switch-when="" class="text-center text-truncate h2">
						{% verbatim %}{{ vm.selection.label }}{% endverbatim %}
						<button width="20" height="20" class="btn btn-icon rounded" style="background-color:rgba(0, 0, 0, 0)" data-clipboard-text="{% verbatim %}{{ vm.selection.label }}{% endverbatim %}" data-toggle="tooltip" data-placement="top" title="Copy Name">
							<svg width="20" height="20" viewBox="0 0 67 67">
								<path d="M61.559,16.528L44.432,0.713C44.064,0.377,43.583,0,43.083,0H25.446c-5.407,0-9.134,2.81-9.134,6.877V12h-3.358    c-4.946,0-8.642,3.124-8.642,7.369V59.37c0,4.492,4.077,7.63,8.642,7.63h29.231c4.677,0,8.127-3.288,8.127-7.63V55h4.365    c4.41,0,7.635-3.513,7.635-8.122V18.555c0-0.029,0.242-0.057,0.241-0.085c0.001-0.03,0.134-0.059,0.134-0.089    C62.688,17.541,62.293,16.824,61.559,16.528z M44.312,6.665L55.462,16H44.312V6.665z M46.312,59.37c0,2.363-1.938,3.63-4.127,3.63    H12.955c-2.323,0-4.642-1.381-4.642-3.63V19.369c0-2.6,3.095-3.369,4.642-3.369h15.358v15.381c0,1.104,1.396,1.619,2.5,1.619h15.5    V59.37z M44.028,29H32.312v-9.878L44.028,29z M54.677,51h-4.365V31.047c0-0.562,0.014-1.097-0.4-1.476l-17.43-16.059    c-0.324-0.667-0.94-1.132-1.732-1.132c-0.036,0-0.039-0.182-0.075-0.18c-0.038-0.002-0.044-0.201-0.083-0.201h-10.28V6.876    c0-2.063,3.02-2.877,5.134-2.877h14.866V18.38c0,1.104,1.396,1.619,2.5,1.619h15.5v26.878C58.312,49.276,56.881,51,54.677,51z" fill="#639dc7"/>
							</svg>
						</button>
					</div>
					<div ng-switch-default class="text-center text-truncate">
						<a href="{% verbatim %}{{ vm.selection.url }}{% endverbatim %}" class="h2 font-weight-bold">
							{% verbatim %}{{ vm.selection.label }}{% endverbatim %}
						</a>
						<button width="20" height="20" class="btn btn-icon rounded" style="background-color:rgba(0, 0, 0, 0)" data-clipboard-text="{% verbatim %}{{ vm.selection.label }}{% endverbatim %}" data-toggle="tooltip" data-placement="top" title="Copy Name">
							<svg width="20" height="20" viewBox="0 0 67 67">
								<path d="M61.559,16.528L44.432,0.713C44.064,0.377,43.583,0,43.083,0H25.446c-5.407,0-9.134,2.81-9.134,6.877V12h-3.358    c-4.946,0-8.642,3.124-8.642,7.369V59.37c0,4.492,4.077,7.63,8.642,7.63h29.231c4.677,0,8.127-3.288,8.127-7.63V55h4.365    c4.41,0,7.635-3.513,7.635-8.122V18.555c0-0.029,0.242-0.057,0.241-0.085c0.001-0.03,0.134-0.059,0.134-0.089    C62.688,17.541,62.293,16.824,61.559,16.528z M44.312,6.665L55.462,16H44.312V6.665z M46.312,59.37c0,2.363-1.938,3.63-4.127,3.63    H12.955c-2.323,0-4.642-1.381-4.642-3.63V19.369c0-2.6,3.095-3.369,4.642-3.369h15.358v15.381c0,1.104,1.396,1.619,2.5,1.619h15.5    V59.37z M44.028,29H32.312v-9.878L44.028,29z M54.677,51h-4.365V31.047c0-0.562,0.014-1.097-0.4-1.476l-17.43-16.059    c-0.324-0.667-0.94-1.132-1.732-1.132c-0.036,0-0.039-0.182-0.075-0.18c-0.038-0.002-0.044-0.201-0.083-0.201h-10.28V6.876    c0-2.063,3.02-2.877,5.134-2.877h14.866V18.38c0,1.104,1.396,1.619,2.5,1.619h15.5v26.878C58.312,49.276,56.881,51,54.677,51z" fill="#639dc7"/>
							</svg>
						</button>
					</div>
				</div>
				<div ng-if="!vm.selection.group.includes('usdt') && vm.selection.group != ''" class="text-center">
					Wallet: <a href="https://www.walletexplorer.com/wallet/{% verbatim %}{{ vm.selection.group }}{% endverbatim %}/addresses">{% verbatim %}{{ vm.selection.walletName }}{% endverbatim %}</a>
				</div>
				<div class="row align-items-start" style="padding-bottom: 1vh;">
					<div class="col-sm-1">
						<img ng-src="{% verbatim %}{{ vm.selection.img }}{% endverbatim %}" width="48" height="48">
					</div>
					<div class="col-sm-7 h1">
						{% verbatim %}{{ vm.selection.balance | number : fractionSize }}{% endverbatim %}
						<button width="20" height="20" class="btn btn-icon rounded" style="background-color:rgba(0, 0, 0, 0)" data-clipboard-text="{% verbatim %}{{ vm.selection.balance }}{% endverbatim %}" data-toggle="tooltip" data-placement="top" title="Copy Balance">
							<svg width="20" height="20" viewBox="0 0 67 67">
								<path d="M61.559,16.528L44.432,0.713C44.064,0.377,43.583,0,43.083,0H25.446c-5.407,0-9.134,2.81-9.134,6.877V12h-3.358    c-4.946,0-8.642,3.124-8.642,7.369V59.37c0,4.492,4.077,7.63,8.642,7.63h29.231c4.677,0,8.127-3.288,8.127-7.63V55h4.365    c4.41,0,7.635-3.513,7.635-8.122V18.555c0-0.029,0.242-0.057,0.241-0.085c0.001-0.03,0.134-0.059,0.134-0.089    C62.688,17.541,62.293,16.824,61.559,16.528z M44.312,6.665L55.462,16H44.312V6.665z M46.312,59.37c0,2.363-1.938,3.63-4.127,3.63    H12.955c-2.323,0-4.642-1.381-4.642-3.63V19.369c0-2.6,3.095-3.369,4.642-3.369h15.358v15.381c0,1.104,1.396,1.619,2.5,1.619h15.5    V59.37z M44.028,29H32.312v-9.878L44.028,29z M54.677,51h-4.365V31.047c0-0.562,0.014-1.097-0.4-1.476l-17.43-16.059    c-0.324-0.667-0.94-1.132-1.732-1.132c-0.036,0-0.039-0.182-0.075-0.18c-0.038-0.002-0.044-0.201-0.083-0.201h-10.28V6.876    c0-2.063,3.02-2.877,5.134-2.877h14.866V18.38c0,1.104,1.396,1.619,2.5,1.619h15.5v26.878C58.312,49.276,56.881,51,54.677,51z" fill="#639dc7"/>
							</svg>
						</button>
					</div>
				</div>
				<div class="row align-items-end justify-content-center">
					<a href="{% verbatim %}{{ vm.selection.webUrl }}{% endverbatim %}" class="font-italic" style="font-size: 65%">
						{% verbatim %}{{ vm.selection.addr }}{% endverbatim %}
					</a>
					<button width="20" height="20" class="btn btn-icon rounded" style="background-color:rgba(0, 0, 0, 0)" data-clipboard-text="{% verbatim %}{{ vm.selection.addr }}{% endverbatim %}" data-toggle="tooltip" data-placement="top" title="Copy Address">
						<svg width="20" height="20" viewBox="0 0 67 67">
							<path d="M61.559,16.528L44.432,0.713C44.064,0.377,43.583,0,43.083,0H25.446c-5.407,0-9.134,2.81-9.134,6.877V12h-3.358    c-4.946,0-8.642,3.124-8.642,7.369V59.37c0,4.492,4.077,7.63,8.642,7.63h29.231c4.677,0,8.127-3.288,8.127-7.63V55h4.365    c4.41,0,7.635-3.513,7.635-8.122V18.555c0-0.029,0.242-0.057,0.241-0.085c0.001-0.03,0.134-0.059,0.134-0.089    C62.688,17.541,62.293,16.824,61.559,16.528z M44.312,6.665L55.462,16H44.312V6.665z M46.312,59.37c0,2.363-1.938,3.63-4.127,3.63    H12.955c-2.323,0-4.642-1.381-4.642-3.63V19.369c0-2.6,3.095-3.369,4.642-3.369h15.358v15.381c0,1.104,1.396,1.619,2.5,1.619h15.5    V59.37z M44.028,29H32.312v-9.878L44.028,29z M54.677,51h-4.365V31.047c0-0.562,0.014-1.097-0.4-1.476l-17.43-16.059    c-0.324-0.667-0.94-1.132-1.732-1.132c-0.036,0-0.039-0.182-0.075-0.18c-0.038-0.002-0.044-0.201-0.083-0.201h-10.28V6.876    c0-2.063,3.02-2.877,5.134-2.877h14.866V18.38c0,1.104,1.396,1.619,2.5,1.619h15.5v26.878C58.312,49.276,56.881,51,54.677,51z" fill="#639dc7"/>
						</svg>
					</button>
				</div>		
			</div>
		</div>
		<div class="row justify-content-center mx-auto" style="padding-top: 2vh; width: 90%">
			<div class="h5 text-center block">
				<div ng-switch="vm.pager.totalItems">
					<div ng-switch-when="1">
						{% verbatim %}{{ vm.pager.totalItems }}{% endverbatim %} Transaction
					</div>
					<div ng-switch-default> 
						{% verbatim %}{{ vm.pager.totalItems }}{% endverbatim %} Transactions
					</div>
				</div>
				<div ng-switch="vm.pager.totalPages">
					<div ng-switch-when="1">
						<span class="font-italic">({% verbatim %}{{ vm.pager.totalPages }}{% endverbatim %} Page)</span>
					</div>
					<div ng-switch-default>
						<span class="font-italic">({% verbatim %}{{ vm.pager.totalPages }}{% endverbatim %} Pages)</span>
					</div>
				</div>
			</div>
			<div class="px-5">
				<ul ng-if="vm.pager.pages.length" class="pagination justify-content-center noselect">
					<li ng-class="{disabled:vm.pager.currentPage === 1 || vm.txLoading}" class="page-item">
						<a ng-click="vm.setPage(1)" class="page-link">First</a>
					</li>
					<li ng-class="{disabled:vm.pager.currentPage === 1 || vm.txLoading}" class="page-item"> 
						<a ng-click="vm.setPage(vm.pager.currentPage - 1)" class="page-link">Previous</a>
					</li>
					<li ng-repeat="page in vm.pager.pages" ng-class="{active:vm.pager.currentPage === page, disabled: vm.txLoading}" class="page-item">
						<a ng-click="vm.setPage(page)" class="page-link">{% verbatim %}{{page}}{% endverbatim %}</a>
					</li>                
					<li ng-class="{disabled:vm.pager.currentPage === vm.pager.totalPages || vm.txLoading}" class="page-item">
						<a ng-click="vm.setPage(vm.pager.currentPage + 1)" class="page-link">Next</a>
					</li>
					<li ng-class="{disabled:vm.pager.currentPage === vm.pager.totalPages || vm.txLoading}" class="page-item">
						<a ng-click="vm.setPage(vm.pager.totalPages)" class="page-link">Last</a>
					</li>
				</ul>
			</div>
			<div class="dropdown block">
				<button type="button" class="btn btn-primary dropdown-toggle" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
					{% verbatim %}{{ vm.dropText }}{% endverbatim %} <span class="caret"></span>
				</button>
				<div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
					<a class="dropdown-item" ng-click="vm.sortBy('time', true)">Most Recent</a>
					<a class="dropdown-item" ng-click="vm.sortBy('value', true)">Transaction Amount <span class="font-italic h6">| Largest to Smallest</span></a>
					<a class="dropdown-item" ng-click="vm.sortBy('value', false)">Transaction Amount <span class="font-italic h6">| Smallest to Largest</span></a>
				</div>
			</div>
		</div>
		<div class="container" ng-switch="vm.txLoading">
			<div ng-switch-when="true" class="text-center mb-5">
				<div class="spinner-grow plus" style="width: 5rem; height: 5rem;" role="status">
					<span class="sr-only">Loading...</span>
				</div>
			</div>
			<div ng-switch-default class="list-group" id="txList" style="position: relative">
				<div ng-repeat="tx in vm.txs" class="list-group-item mx-auto" style="width: 90%;">
					<div class="row align-items-start" style="padding-bottom: 1vh;">
						<div class="col-sm-1">
							<img ng-src="{% verbatim %}{{ tx.img }}{% endverbatim %}" width="48" height="48">
						</div>
						<div class="col-sm-7 h1">
							{% verbatim %}{{ tx.amount | number : fractionSize }}{% endverbatim %}
							<span ng-if="tx.type !== 'USDTTX'" class="h6">(${% verbatim %}{{ tx.value | number : 2 }}{% endverbatim %})</span>
							<button width="20" height="20" class="btn btn-icon" style="background-color:rgba(0, 0, 0, 0)" data-clipboard-text="{% verbatim %}{{ tx.amount }}{% endverbatim %}" data-toggle="tooltip" data-placement="top" title="Copy Transaction Amount">
								<i class="far fa-copy fa-lg"></i>
							</button>
						</div>
						<div class="col-sm-4 h5 font-italic text-right">{% verbatim %}{{ vm.formatTime(tx.time) }}{% endverbatim %}</div>
					</div>
					<div class="justify-content-center" ng-class="{row: vm.rowTxs, 'text-center': !vm.rowTxs}" style="padding-bottom: 1rem;">
						<div class="block" ng-class="{'col-6': vm.rowTxs, 'ml-n4': vm.rowTxs, 'text-right': vm.rowTxs}" style="position: relative; whitespace: nowrap;">
							<button width="16" height="16" ng-click="vm.highlight(tx.from, true)" class="btn btn-icon" 
								style="background-color: rgba(0, 0, 0, 0)" data-toggle="tooltip" data-placement="top" 
								title="Highlight on Graph" ng-class="{disabled: !vm.isGraph}">
								<i class="fas fa-highlighter"></i>
							</button>
							<a href="{% verbatim %}{{ tx.sourceUrl }}{{ vm.dURLParams }}{% endverbatim %}" ng-click="vm.startLoader();" class="h6">
								{% verbatim %}{{ tx.source }}{% endverbatim %}
							</a>
							<button width="16" height="16" class="btn btn-icon" style="background-color: rgba(0, 0, 0, 0)" data-clipboard-text="{% verbatim %}{{ tx.sourceAddr }}{% endverbatim %}" data-toggle="tooltip" data-placement="top" title="Copy Sender Address">
								<i class="far fa-copy"></i>
							</button>
						</div>
						<i class="fas fa-arrow-right" ng-if="vm.rowTxs"></i>
						<i class="fas fa-arrow-down" ng-if="!vm.rowTxs"></i>
						<div class="block" ng-class="{'col-6': vm.rowTxs, 'mr-n4': vm.rowTxs, 'text-left': vm.rowTxs}" style="position: relative; whitespace: nowrap;">
							<button width="16" height="16" ng-click="vm.highlight(tx.to, true)" class="btn btn-icon" 
								style="background-color: rgba(0, 0, 0, 0)" data-toggle="tooltip" data-placement="top"
								title="Highlight on Graph" ng-class="{disabled: !vm.isGraph}">
								<i class="fas fa-highlighter"></i>
							</button>
							<a href="{% verbatim %}{{ tx.targetUrl }}{{ vm.dURLParams }}{% endverbatim %}" ng-click="vm.startLoader();" class="h6">
								{% verbatim %}{{ tx.target }}{% endverbatim %}
							</a>
							<button width="16" height="16" class="btn btn-icon" style="background-color: rgba(0, 0, 0, 0)" data-clipboard-text="{% verbatim %}{{ tx.targetAddr }}{% endverbatim %}" data-toggle="tooltip" data-placement="top" title="Copy Reference Address">
								<i class="far fa-copy"></i>
							</button>	
						</div>
					</div>
					<div class="row align-items-end justify-content-center">
						<button width="16" height="16" ng-click="vm.highlight({source: tx.source, target: tx.target}, false)" 
							class="btn btn-icon" style="background-color: rgba(0, 0, 0, 0)" data-toggle="tooltip" 
							data-placement="top" title="Highlight on Graph" ng-class="{disabled: !vm.isGraph}">
							<i class="fas fa-highlighter"></i>
						</button>
						<a href="{% verbatim %}{{ tx.txidUrl }}{% endverbatim %}" ng-click="vm.startLoader();" class="font-italic text-truncate" style="font-size: 65%">
							{% verbatim %}{{ tx.txid }}{% endverbatim %}
						</a>
						<button width="16" height="16" class="btn btn-icon" style="background-color: rgba(0, 0, 0, 0)" data-clipboard-text="{% verbatim %}{{ tx.txid }}{% endverbatim %}" data-toggle="tooltip" data-placement="top" title="Copy TxID">
							<i class="far fa-copy"></i>
						</button>		
					</div>
				</div>
			</div>
		</div>
		<div class="row mx-auto justify-content-center mt-3">
			<div class="ml-3">
				<ul ng-if="vm.pager.pages.length" class="pagination justify-content-center noselect">
					<li ng-class="{disabled:vm.pager.currentPage === 1 || vm.txLoading}" class="page-item">
						<a ng-click="vm.setPage(1)" class="page-link">First</a>
					</li>
					<li ng-class="{disabled:vm.pager.currentPage === 1 || vm.txLoading}" class="page-item"> 
						<a ng-click="vm.setPage(vm.pager.currentPage - 1)" class="page-link">Previous</a>
					</li>
					<li ng-repeat="page in vm.pager.pages" ng-class="{active:vm.pager.currentPage === page, disabled:vm.txLoading}" class="page-item">
						<a ng-click="vm.setPage(page)" class="page-link">{% verbatim %}{{page}}{% endverbatim %}</a>
					</li>                
					<li ng-class="{disabled:vm.pager.currentPage === vm.pager.totalPages || vm.txLoading}" class="page-item">
						<a ng-click="vm.setPage(vm.pager.currentPage + 1)" class="page-link">Next</a>
					</li>
					<li ng-class="{disabled:vm.pager.currentPage === vm.pager.totalPages || vm.txLoading}" class="page-item">
						<a ng-click="vm.setPage(vm.pager.totalPages)" class="page-link">Last</a>
					</li>
				</ul>
			</div>
		</div>
	</div>
	<script src="{% static 'js/graph.js' %}"></script>
	<script>
		var clipboard  = new ClipboardJS('.btn');
		
		var tempFilters = {};

		clipboard.on('success', function (e) {
			e.action
			e.clearSelection();
		});

		clipboard.on('error', function (e) {
			console.error('Action:', e.action);
			console.error('Trigger:', e.trigger);
		});

		$(".dropdown-hover").hover(e => {
			var el = e.currentTarget;
			if (!$(el).hasClass("show")) {
				$(el).find(".dropdown-toggle").dropdown('toggle');
			}
		}, e => {
			var el = e.currentTarget;
			var inputEl;
			if (el.id == "time") {
				inputEl = $(`input[name='${$(el).attr("data-lastEdit")}']`);
			}

			if (el.id == "time" && tempFilters[$(inputEl).attr("name")] != $(inputEl).val()) {
				tempFilters[$(inputEl).attr("name")] = $(inputEl).val();
				$(inputEl).focus();
			} else if ($(el).hasClass("show")) {
				$(el).find(".dropdown-toggle").dropdown('toggle');
			}
		});

		/*
		function isDateOpen() {
			var dates = $(".daterangepicker");
			for (var i = 0; i < dates.length; i++) {
				if ($(dates[i]).css("display") != "none") {
					return true;
				}
			}

			return false;
		}
		*/

		function numberWithCommas(x) {
			var parts = x.toString().split(".");
			parts[0] = parts[0].replace(/\B(?=(\d{3})+(?!\d))/g, ",");
			return parts.join(".");
		}

		$('.dropdown-menu').on('click', e => {
			e.stopPropagation();
		});

		$(".dropdown-hover input").focus(e => {
			var el   = e.target;
			if ($(el).val() == "max" || $(el).val() == "min" || $(el).val() == "oldest" || $(el).val() == "latest" /*|| dFilters[el.name] == $(el).val().replace(/,/g, "")*/) {
				$(el).val("");
				$(el).removeClass("filterChange");
				tempFilters[$(el).attr("name")] = $(el).val();
			}
		}).blur(e => {
			var el = e.target;
			if ($(el).val() == "") {
				$(el).val(numberWithCommas(dFilters[el.name]));
				$(el).removeClass("filterChange");
			} else {
				$(el).addClass("filterChange");
			}

			tempFilters[$(el).attr("name")] = $(el).val();
		});
	</script>
</body>
{% endif %}
</html>